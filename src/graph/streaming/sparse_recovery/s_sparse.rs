//! More Generalized s-Sparse Recovery

use super::one_sparse::{OneSparseRecovery, OneSparseRecoveryOutput};
use crate::utils::hash_function::HashFunction;
use num_primes::Generator;
use std::{collections::HashMap, fmt::Debug};

/// S-Sparse Recovery Data Structure
///
/// Algorithm for recovery and detection is based off of [Algorithm 15](https://www.cs.dartmouth.edu/~ac/Teach/CS35-Spring20/Notes/lecnotes.pdf)
///
/// Storage: O(tlog(t) + tlog(n))
#[derive(Clone)]
pub struct SparseRecovery<F: HashFunction> {
    /// Sparsity Parameter
    ///
    /// Constant Space
    s: u64,
    /// The Sparse Recovery Data Structures
    ///
    /// Stores O(2st) = O(slog(s/del))
    structures: Vec<Vec<OneSparseRecovery>>,
    /// Hash Functions for hashing to the Sparse recovery systems
    /// Store O(t * HF bits)
    functions: Vec<F>,
}

impl<F: HashFunction> Debug for SparseRecovery<F> {
    fn fmt(&self, f: &mut std::fmt::Formatter<'_>) -> std::fmt::Result {
        write!(f, "{}-Sparse Recovery Structure", self.s)
    }
}

impl<F> SparseRecovery<F>
where
    F: HashFunction,
{
    /// Initialize a new S-Sparse Detection and Recovery Data Structure
    ///
    /// - *n* : Universe Size
    /// - *s* : Sparsity we wish to detect
    /// - *del* : Error probability controller
    pub fn init(n: u64, s: u64, del: f32) -> Self {
        let t = (s as f32 / del).log2().ceil() as u64;

        let order = {
            let prime_bits = (3_f64 * (n as f64).log2()).ceil() as u64 + 1;
            let prime = Generator::new_prime(prime_bits);
            prime
                .to_u32_digits()
                .into_iter()
                .enumerate()
                .fold(0, |val, (i, next)| {
                    let digit_value = 32u64.pow(i as u32) * next as u64;
                    val + digit_value
                })
        };

        let structures = (0..t)
            .into_iter()
            .map(|_| {
                (0..(2 * s))
                    .into_iter()
                    .map(|_| OneSparseRecovery::init_with_order(n, order))
                    .collect()
            })
            .collect();

        let functions = (0..t).into_iter().map(|_| F::init(n, 2 * s)).collect();

        Self {
            s,
            structures,
            functions,
        }
    }

    /// Feed a token into the Structure
    pub fn feed(&mut self, token: (u64, bool)) {
        let Self {
            structures,
            functions,
            ..
        } = self;
        let (j, _) = token;
        structures
            .iter_mut()
            .zip(functions.iter())
            .enumerate()
            .for_each(|(_, (recoveries, hasher))| {
                let hashed_index = hasher.compute(j);
                if let Some(recovery) = recoveries.get_mut(hashed_index) {
                    recovery.feed(token);
                } else {
                    panic!("ERROR HASHED INDEX OUT OF BOUNDS");
                }
            });
    }

    /// Query the Structure for detection and recovery
    ///
    /// The HashMap contains a mapping from indices which are part of the recovery to the values they contained.
    ///
    /// If the stream was not s-sparse, or if one of the one-sparse recovery systems got an answer wrong, then we return `None`.
    pub fn query(self) -> Option<HashMap<u64, i64>> {
        let mut recovery = HashMap::new();

        for row in self.structures {
            for cell in row {
                let res = cell.query();
                match res {
                    OneSparseRecoveryOutput::VeryLikely(lambda, i) => {
                        if recovery
                            .get(&i)
                            .map(|val| val != &lambda)
                            .unwrap_or_default()
                        {
                            return None;
                        }
                        recovery.insert(i, lambda);
                        if recovery.keys().len() > self.s as usize {
                            return None;
                        }
                    }
                    _ => continue,
                }
            }
        }
        Some(recovery)
    }
}

#[cfg(test)]
mod test {
    use std::collections::HashSet;

    use crate::utils::hash_function::FieldHasher;

    use super::*;

    fn is_s_sparse() -> bool {
        let stream: Vec<(u64, bool)> = vec![
            (0, true),
            (9, true),
            (7, true),
            (6, true),
            (7, true),
            (9, true),
            (7, true),
            (9, false),
            (9, false),
        ];

        let mut recovery = SparseRecovery::<FieldHasher>::init(10, 3, 0.01);

        stream.into_iter().for_each(|token| recovery.feed(token));

        let mut expected: HashSet<(u64, i64)> = HashSet::new();
        expected.insert((0, 1));
        expected.insert((6, 1));
        expected.insert((7, 3));

        recovery
            .query()
            .map(|actual| {
                actual
                    .into_iter()
                    .collect::<HashSet<(u64, i64)>>()
                    .is_subset(&expected)
            })
            .unwrap_or_default()
    }

    fn not_s_sparse() -> Option<HashMap<u64, i64>> {
        let stream: Vec<(u64, bool)> = vec![
            (1, true),
            (2, true),
            (3, true),
            (4, true),
            (5, true),
            (5, true),
            (5, true),
        ];

        let mut recovery = SparseRecovery::<FieldHasher>::init(100, 2, 0.01);

        stream.into_iter().for_each(|token| recovery.feed(token));

        recovery.query()
    }

    #[test]
    fn not_sparse_probability() {
        let n = 10;

        let mut incorrect = 0;

        for _ in 0..n {
            let res = not_s_sparse();
            if res.is_some() {
                incorrect += 1;
            }
        }

        let probability = incorrect as f32 / n as f32;
        assert!(probability <= 0.01);
    }

    #[test]
    fn sparse_probability() {
        let n = 100;

        let mut incorrect = 0;

        for _ in 0..n {
            if !is_s_sparse() {
                incorrect += 1;
            }
        }

        let probability = incorrect as f32 / n as f32;
        assert!(probability <= 0.01);
    }

    fn foobar() -> Option<HashMap<u64, i64>> {
        let stream = vec![
            861, 1176, 4851, 8385, 15576, 20910, 23653, 23871, 30876, 33411, 35511, 41041, 42486,
            53628, 55611, 55945, 56953, 2629, 18722, 3573, 14035, 7390, 17214, 31635, 52013, 1553,
            34993, 10310, 47912, 9201, 27516, 49476, 59361, 38248, 1620, 19925, 36610, 37975,
            39085, 3107, 8937, 9896, 14222, 17604, 30654, 47304, 13893, 85525, 19342, 7299, 2251,
            6368, 8686, 8818, 36896, 37441, 6146, 19945, 49191, 28017, 18388, 1484, 3881, 4239,
            18198, 50139, 1595, 22422, 35036, 41961, 22635, 3380, 31184, 14427, 3386, 28507, 5423,
            6395, 36923, 44023, 25268, 19975, 17657, 3908, 4266, 3568, 7342, 14447, 25286, 9267,
            49542, 7963, 5984, 7001, 7119, 28301, 15675, 17866, 20807, 9283, 17123, 6432, 28309,
            446147, 489662, 547688, 560318, 561377, 573092, 597978, 614493, 622277, 623393, 647060,
            688658, 752258, 757172, 818667, 821228, 837972, 885222, 887885, 903947, 912032, 952997,
            964073, 971028, 987822, 1000512, 1018985, 1026135, 1031873, 1047735, 1059347, 1103462,
            1188218, 1214568, 1216127, 1257012, 1266543, 1463012, 1475010, 1520003, 1535735,
            1610222, 1657217, 1800360, 1807958, 40294, 7012, 7130, 43474, 45862, 8759, 10991,
            25540, 9846, 28321, 17327, 22700, 31748, 59812, 25782, 29293, 30762, 49591, 2017172,
            2227241, 2239922, 2729752, 2793202, 3108907, 37004, 48046, 57443, 49613, 52811, 30797,
            31295, 40640, 17937, 685206, 1199097, 19873, 26968, 58483, 150599, 210449, 38678,
            51859, 44731, 49640, 22764, 24939, 31812, 18908, 32318, 21716, 32325, 158964, 26995,
            58510, 36785, 38150, 39260, 28644, 34133, 36518, 54160, 24964, 53846, 31849, 46280,
            42426, 32873, 45989, 34169, 51927, 57551, 38221, 39331, 49412, 44228, 46938, 51958,
            55223, 51340, 54264, 56926, 53287, 59655, 64968, 73884, 82969, 84603, 97809, 105918,
            111976, 126601, 144264, 149679, 150226, 157428, 160809, 161376, 211928, 1105194,
            1398981, 112456, 104553, 97821, 105930, 150238, 157440, 160821, 69740, 116283, 121148,
            67891, 83799, 85029, 1430949, 125614, 87102, 132721, 152994, 168276, 844716, 861694,
            1434337, 83804, 85034, 143748, 72759, 113895, 75448, 137920, 138971, 85864, 111058,
            121159, 135313, 137399, 143219, 91754, 101401, 120181, 154111, 201037, 694807, 106408,
            123138, 160273, 205498, 75846, 102308, 131716, 958809, 1078635, 1084517, 145381, 77812,
            80191, 96094, 112966, 123647, 132233, 156912, 80194, 83422, 96097, 112969, 180694,
            80195, 83423, 88805, 96098, 123651, 128666, 180695, 81399, 115836, 88807, 128668,
            104138, 121676, 144851, 83428, 88810, 96103, 112975, 123656, 180700, 133788, 105056,
            98750, 116325, 131733, 96111, 138483, 85075, 131225, 143789, 119240, 131228, 142190,
            182518, 121200, 137440, 184942, 190450, 206817, 209395, 212640, 222525, 223192, 87152,
            125166, 158619, 125167, 132772, 153045, 153046, 93084, 133805, 1431006, 155824, 188613,
            95253, 154713, 172414, 233326, 127684, 103711, 111111, 137452, 101903, 176549, 694859,
            93526, 110176, 116833, 133817, 116835, 148128, 154726, 233339, 113013, 123694, 128709,
            133825, 106012, 135384, 158652, 109731, 147608, 121734, 122721, 144909, 123218, 112088,
            149791, 160921, 107414, 141708, 115903, 128230, 147076, 133339, 137497, 126726, 157553,
            123731, 128746, 432460, 629356, 130784, 148179, 420469, 422304, 455064, 525283, 658861,
            1087558, 1238434, 1409164, 1499529, 1768623, 1770504, 1791261, 156445, 183799, 500984,
            1286090, 153667, 125237, 131304, 155335, 137518, 144946, 145484, 160391, 205616,
            128768, 138572, 153128, 158703, 168410, 144419, 157583, 160964, 128269, 140160, 146574,
            138582, 143892, 148752, 138063, 139114, 153143, 168425, 871057, 1145858, 141234,
            149304, 137546, 139126, 1619626, 149316, 158737, 148776, 157617, 160998, 979838,
            1580291, 1763041, 150425, 233459, 174904, 183874, 188750, 224005, 161022, 1424391,
            667001, 191226, 177884, 169648, 199973, 228052, 201873, 221358, 173745, 204420, 207625,
            220032, 844930, 861908, 1190233, 1434551, 199978, 228057, 189388, 232809, 194343,
            231450, 183906, 224037, 202522, 213470, 229422, 637352, 1478936, 1670474, 234184,
            629482, 183313, 188797, 224052, 501106, 220727, 231471, 198747, 224060, 234202, 229445,
            194375, 230125, 219418, 221408, 222075, 232851, 230134, 228107, 213514, 401597, 619465,
            887083, 1237015, 216793, 212220, 511206, 868554, 1105492, 1399279, 1560912, 234924,
            232210, 237702, 246036, 274856, 283062, 292152, 312341, 313922, 347214, 350552, 355589,
            359814, 299838, 302163, 336477, 338940, 293683, 332393, 357278, 278576, 339769, 260975,
            343072, 263870, 305285, 328340, 344730, 354756, 243950, 340598, 370068, 376109, 379583,
            382199, 386579, 399869, 315521, 352243, 288364, 335674, 342254, 366643, 285340, 289125,
            289885, 302958, 319506, 322708, 254534, 266793, 377854, 396313, 339785, 324320, 307647,
            316326, 358992, 298319, 299864, 302189, 320313, 338966, 277855, 348076, 336506, 365802,
            310009, 266805, 314748, 339800, 268271, 305316, 344761, 324337, 279359, 304538, 389250,
            324341, 311598, 310814, 339813, 310030, 296805, 278627, 279376, 343951, 348106, 304557,
            344783, 343129, 339006, 395469, 299132, 355667, 332471, 352309, 318772, 366709, 317976,
            334924, 320372, 349803, 320374, 336564, 339027, 380532, 348141, 328426, 344816, 354842,
            327619, 316399, 358220, 343992, 317201, 350658, 334129, 361618, 339053, 394632, 387565,
            327644, 354871, 342365, 357405, 361642, 342370, 353199, 366759, 339073, 360803, 348190,
            366780, 374537, 377135, 6921922, 377143, 382368, 396474, 386752, 392043, 392933,
            400050, 545342, 849149, 911471, 1068887, 1237274, 1297751, 1429791, 1555862, 1663472,
            1711221, 1733487, 587883, 743268, 926377, 1008387, 1065967, 1178242, 444109, 1147753,
            1039860, 408154, 625304, 940036, 1358029, 569613, 1093883, 1752158, 625306, 940038,
            1358031, 1179785, 731142, 875409, 990027, 1082091, 1280106, 449785, 667342, 1419677,
            645588, 704799, 894024, 1209143, 1260986, 1179792, 1372908, 644458, 688291, 1799270,
            616410, 1238866, 1338345, 1769055, 590071, 808001, 837487, 983017, 1170601, 1299382,
            1456987, 1465532, 1496501, 1765297, 422738, 455498, 681278, 1499963, 1791695, 1499965,
            1729790, 805467, 1254657, 1349824, 1382874, 1402896, 1696482, 899392, 997090, 1199850,
            480635, 701261, 832330, 847876, 1155365, 1184416, 1302616, 1391203, 1679953, 1685455,
            1822111, 714342, 1202952, 1264182, 1703862, 1713102, 563258, 882056, 1689132, 629811,
            732375, 1672637, 687138, 883388, 738438, 770353, 810561, 579284, 636562, 978835,
            1008424, 1137212, 1661687, 1172150, 1353126, 1114716, 1795503, 1131196, 815667,
            1021247, 1273751, 1670819, 775332, 1147797, 1251513, 683640, 988660, 524722, 582527,
            657031, 660472, 728767, 781571, 851806, 1149316, 1196777, 1515616, 1543592, 1550626,
            1654417, 1668997, 914223, 948323, 1111742, 1167575, 1286553, 1678143, 1778502, 575005,
            1423091, 878101, 1141756, 493480, 899422, 1212298, 1426468, 1382906, 1386233, 1402928,
            1696514, 1500000, 1791732, 585778, 627597, 1242057, 1265802, 1369642, 1472427, 1281758,
            721559, 1286565, 1678155, 472866, 541240, 571806, 602119, 505474, 1179845, 1450218,
            581469, 743337, 926446, 978867, 1661719, 1667191, 787852, 836245, 966322, 1158448,
            1262633, 1683662, 1105809, 925090, 1227931, 484607, 670874, 541252, 571818, 762970,
            1012728, 1034178, 1531353, 832385, 1155420, 1680008, 637737, 1273791, 641128, 1506962,
            1722422, 952493, 992919, 680179, 750686, 850542, 1064599, 1803139, 4155393, 4672086,
            1489666, 831109, 899463, 1212339, 1416396, 1419763, 1426509, 1612903, 1328629, 673215,
            811896, 875498, 1067525, 766700, 1155437, 1288207, 1391275, 529904, 517635, 702519,
            1285002, 1307535, 1364725, 1508715, 1524384, 1618300, 1620099, 1086601, 914277, 504509,
            1317256, 1343344, 1364729, 1474189, 1508719, 1524388, 1618304, 1620103, 1761629,
            517640, 676707, 702524, 803015, 1076315, 1285007, 1307540, 1317257, 1364730, 1474190,
            1524389, 1618305, 1620104, 1761630, 733661, 789146, 963584, 1469047, 1643584, 1756007,
            609863, 1379637, 576136, 894124, 763004, 1012762, 1487960, 575067, 1527889, 922415,
            1700258, 533010, 604365, 790410, 864970, 1117780, 668607, 676720, 702537, 704908,
            803028, 938782, 1076328, 1285020, 1307553, 1317270, 1364743, 1508733, 1524402, 1618318,
            1620117, 607669, 815744, 1479358, 1017044, 1265864, 866290, 1064631, 1517431, 1524405,
            1533145, 755627, 1724317, 1810774, 606574, 638909, 728845, 833719, 851884, 1149394,
            1636360, 1806975, 861042, 1024191, 1232691, 1503537, 1563054, 1782354, 1254764,
            1382981, 679059, 789169, 1294665, 1643607, 716836, 604383, 684900, 840195, 1025632,
            1131293, 1047220, 1636375, 565493, 571886, 1709516, 553868, 895495, 936073, 713267,
            965013, 1215508, 1536675, 1808898, 702568, 1076359, 1474234, 1524433, 1620148, 1640003,
            636677, 817052, 978950, 1207730, 1351595, 1256370, 1582581, 794221, 1042897, 1510504,
            706130, 895505, 1031382, 1163102, 1491453, 1634581, 781679, 1301132, 1550734, 1654525,
            1669105, 616551, 1061752, 1232721, 1277059, 1563084, 1215520, 1611174, 753211, 882189,
            1042908, 571909, 902217, 1085192, 1094048, 1253220, 1750452, 673288, 1507048, 750770,
            754448, 1119330, 1328705, 1333598, 1460556, 1799426, 756909, 747106, 966430, 1002895,
            1158556, 1649095, 581579, 718079, 926556, 978977, 1008566, 1207757, 1315707, 1351622,
            1393022, 718081, 743449, 926558, 978979, 1008568, 1207759, 1393024, 1661831, 1667303,
            606629, 657164, 781704, 891524, 1047260, 1149449, 1161605, 1196910, 1301157, 1515749,
            1543725, 1550759, 1654550, 1669130, 600045, 922483, 1700326, 627722, 1242182, 1265927,
            1472552, 634458, 1024248, 1061779, 1107411, 1144911, 1277086, 1310854, 1627389,
            1782411, 694338, 6321875, 6339665, 6511721, 6598613, 6748386, 7207791, 7333620,
            7514711, 618802, 710922, 808171, 810714, 842839, 983187, 1457157, 1496671, 1765467,
            1009998, 682617, 737383, 1102962, 1231189, 1799451, 703802, 867684, 925218, 1228059,
            609956, 818381, 728922, 756936, 891546, 1149471, 1196932, 1301179, 1515771, 1543747,
            1550781, 1636437, 1669152, 818385, 969240, 1031434, 1259595, 908984, 1005759, 831223,
            899577, 1183060, 1416510, 1600473, 1613017, 1698510, 1731837, 1117873, 1128359,
            1494964, 1019987, 861126, 903606, 1486336, 1299578, 887559, 1571991, 779242, 865070,
            1356596, 886231, 819677, 886232, 965083, 1060357, 1215578, 1611232, 1801370, 1808968,
            940253, 1358246, 1242220, 1265965, 1369805, 1472590, 707387, 752046, 859826, 1119381,
            1406448, 633373, 690848, 1778678, 687330, 923885, 1063277, 1080839, 1340190, 1570230,
            1691165, 914401, 1111920, 1286731, 1778680, 715736, 903622, 1024291, 1107454, 1277129,
            1293154, 1310897, 1563154, 1627432, 1782454, 776762, 1083783, 1345107, 979029, 1008618,
            1207809, 1315759, 1661881, 815855, 1273939, 1479469, 851990, 1196961, 1636466, 754509,
            850687, 1460617, 977635, 1082317, 1138918, 1280332, 1507112, 688513, 702655, 773038,
            1076446, 1285138, 1524520, 1620235, 1209371, 1261214, 1453796, 1175415, 1083795,
            1146483, 1602297, 1265988, 660672, 756981, 781771, 833841, 852006, 1196977, 1301224,
            1515816, 1543792, 1550826, 1669197, 1088223, 1338578, 781774, 852009, 1149519, 1301227,
            1550829, 1654620, 1669200, 1448701, 1726303, 1822336, 1126901, 943030, 1632873, 805699,
            1095613, 1254889, 1383106, 1386433, 1696714, 1134420, 688534, 829984, 938921, 1210946,
            1285159, 1364882, 1524541, 1618457, 1620256, 1788151, 1201633, 1325536, 1694878,
            858554, 1589812, 1593379, 875663, 1280360, 1507140, 873021, 702683, 829991, 938928,
            1210953, 1307699, 1364889, 1524548, 1620263, 1351710, 958201, 1007236, 1741210, 791819,
            1131422, 1169325, 1319045, 840330, 947172, 1275578, 1314182, 1340238, 1691213, 1744950,
            773076, 1343514, 1474359, 1620273, 1640128, 1027202, 721775, 914451, 948551, 1167803,
            984680, 937574, 1346798, 1047361, 1515850, 1531556, 914458, 948558, 1167810, 1180063,
            1450436, 1155624, 1184675, 1288394, 1391462, 1638329, 1680212, 773088, 803196, 1076496,
            1285188, 1307721, 1317438, 1343526, 1364911, 1508901, 1524570, 1618486, 1620285,
            1788180, 1261265, 1453847, 764418, 813363, 895641, 752114, 859894, 1119449, 1328824,
            1460675, 763185, 1312581, 738697, 842945, 907723, 951323, 1272407, 1264450, 1704130,
            1713370, 717002, 926678, 979099, 1351744, 726609, 771860, 884984, 932129, 1203224,
            1296444, 1376510, 1482980, 1737515, 914477, 948577, 1248611, 804480, 795634, 874385,
            1793875, 884990, 1100108, 1203230, 1296450, 1482986, 1737521, 1047388, 1149577,
            1636543, 990330, 1280409, 1294847, 1469252, 1535087, 1643789, 1015812, 993150, 1484717,
            810843, 907746, 1526347, 1098638, 1443668, 1632938, 926699, 979120, 842974, 788107,
            1262888, 1381513, 1607750, 1649242, 1683917, 1776892, 1443674, 850781, 1328860,
            1333753, 859931, 1119486, 1328861, 1460712, 758292, 822348, 905067, 954117, 1048855,
            850784, 1724525, 833925, 891675, 1149600, 1197061, 1515900, 1669281, 1826235, 905071,
            1048859, 1267667, 1687598, 998813, 1012988, 1034438, 1589888, 1728246, 813411, 895689,
            1072153, 848189, 1155678, 1184729, 1288448, 1302929, 1391516, 1680266, 810869, 945867,
            1376553, 803254, 1317496, 1343584, 1524628, 1618544, 1620343, 1640198, 1251816,
            1128498, 1495103, 853414, 1450502, 891695, 1161776, 1197081, 1301328, 1515920, 1543896,
            1654721, 1669301, 966610, 968000, 1003075, 1158736, 1262921, 1381546, 1683950, 963834,
            1469297, 1643834, 1411617, 1254994, 1335419, 794429, 1647464, 1647465, 1707889,
            1793932, 939032, 1076578, 1285270, 1307803, 1317520, 1474453, 1524652, 1618568,
            1620367, 1788262, 1172483, 1095729, 1255005, 1350172, 1383222, 1403244, 1538650,
            1588140, 983372, 1299737, 1457342, 1465887, 1765652, 883728, 947272, 1050348, 1691313,
            997439, 1272488, 1044564, 1228235, 895728, 1163325, 1586365, 1274087, 1479617, 1259770,
            886395, 1060520, 1809131, 1589934, 954172, 988997, 1160286, 1724580, 1296530, 1805335,
            1780727, 883743, 1314297, 939053, 1474474, 1524673, 1620388, 1155730, 1302981, 1680318,
            891736, 1149661, 1197122, 1301369, 1515961, 1550971, 1669342, 986198, 1064903, 1803443,
            1158774, 1262959, 1381584, 1683988, 1200220, 907829, 951429, 862628, 1435271, 1391580,
            1638447, 1680330, 1237681, 1556269, 1656593, 1663879, 1460790, 1149675, 1161831,
            1301383, 1543951, 1550985, 1136077, 1450559, 1335469, 943187, 1057640, 1137587,
            1119571, 1328946, 1024477, 1145140, 1232977, 1503823, 1563340, 1782640, 1190966,
            1435284, 1175592, 1356796, 1517727, 1228278, 1046053, 1687685, 1146661, 990444,
            1139109, 1222026, 1379954, 1142130, 1186357, 1309480, 1416730, 1426843, 1573978,
            1715353, 947329, 1314339, 1340395, 1425157, 1745107, 1100233, 1203355, 1296575,
            1483111, 1805380, 1060571, 1215792, 1809182, 1572210, 1622232, 1328969, 1643912,
            1700580, 1799690, 1047516, 1149705, 1197166, 1301413, 1543981, 1669386, 924097,
            1050412, 1332232, 1691377, 1163388, 914615, 1112134, 1778894, 903836, 1782668, 1183294,
            1416744, 1420111, 1600707, 1085471, 1186373, 1024509, 1233009, 1486570, 1627650,
            1782672, 954235, 1048973, 1267781, 951478, 1169504, 1319224, 1514279, 1519502, 1298205,
            1556316, 1609671, 1733941, 1033117, 1658461, 1809202, 948728, 1112147, 1167980,
            1248762, 1286958, 1604297, 1778907, 944609, 1143674, 1396643, 1700604, 1081074,
            1340425, 1570465, 1691400, 1745137, 1228321, 979262, 1008851, 1208042, 1351907,
            1393307, 1085494, 1760116, 1312757, 1481427, 1709843, 1743278, 1307906, 1524755,
            1620470, 1057704, 1137651, 1455738, 1818744, 1143690, 1700620, 1376686, 1275782,
            1314386, 1332272, 1340442, 1691417, 1112172, 1168005, 1286983, 1604322, 1778932,
            1790264, 1656672, 1295024, 1469429, 1643966, 1215850, 1801642, 968135, 1003210,
            1158871, 1263056, 1381681, 1607918, 1649410, 1684085, 1158872, 1263057, 1271012,
            1381682, 1607919, 1649411, 1684086, 1168021, 1595401, 1750781, 1180277, 1082583,
            1008889, 1178744, 1208080, 1316030, 1393345, 1662152, 1667624, 1353590, 1782729,
            1457473, 1065015, 1803555, 1303096, 5547520, 1653061, 1200338, 1013166, 1493541,
            1590066, 1728424, 1263082, 1684111, 1037499, 1208101, 1316051, 1393366, 1662173,
            1034626, 1493551, 1597215, 1148281, 1266271, 1370111, 1378397, 1437092, 1671307,
            1062127, 1107759, 1233096, 1277434, 1293459, 1311202, 1503942, 1563459, 1627737,
            1782759, 1038954, 1491837, 1809288, 1728449, 1467772, 1510897, 1301525, 1516117,
            1551127, 1636783, 1669498, 1063602, 1691490, 1745227, 5264840, 1590104, 1078230,
            1455819, 1368486, 1189567, 1215917, 1801709, 1809307, 1107785, 1277460, 1311228,
            1782785, 1629568, 1651294, 1517870, 1803610, 1316091, 1545864, 1237840, 1298317,
            1430357, 1556428, 1734053, 1449016, 2426968, 1285470, 1308003, 1317720, 1343808,
            1524852, 1618768, 1620567, 1760219, 1340536, 1745248, 1139257, 1222174, 1280671,
            1507451, 1421927, 1338905, 1792253, 1676843, 1253632, 1595484, 1750864, 1752735,
            1588351, 1266326, 1530107, 1203508, 1483264, 1756485, 1505730, 1277491, 1311259,
            1563516, 1627794, 1782816, 1130242, 1306410, 1604436, 1796058, 1304799, 1128746,
            1495351, 1329131, 1460982, 1822687, 1495358, 1335665, 1398463, 1706288, 1222212,
            1558239, 1252086, 1266360, 1197347, 1301594, 1516186, 1544162, 1551196, 1654987,
            1669567, 1206647, 1212865, 1732249, 1680548, 1263188, 1649542, 1684217, 1174269,
            1280723, 1301602, 1544170, 1669575, 1586615, 1395142, 1604473, 1299996, 1457601,
            1497115, 1765911, 1388479, 1393481, 1327542, 1450789, 1597327, 1366916, 1600904,
            1212886, 1309693, 1416943, 1427056, 1413581, 1801795, 1809393, 1552986, 1301625,
            1516217, 1544193, 1636883, 1669598, 1581302, 1325928, 1695270, 1758425, 1296796,
            1737867, 1304858, 1631468, 1732283, 1316185, 1393500, 1667779, 1261633, 1454215,
            1366935, 1416960, 1420327, 1427073, 1462752, 1600923, 1613467, 1732287, 1537187,
            1801812, 1809410, 1507543, 1321065, 1432151, 1551246, 1502346, 1298424, 1361994,
            1734160, 1277573, 1293598, 1504081, 1563598, 1627876, 1782898, 1263237, 1381862,
            1608099, 1275978, 1425400, 1298428, 1430468, 1734164, 1410255, 1771595, 1370261,
            1473046, 1830405, 2178318, 2318205, 2967407, 3028607, 3102872, 3152882, 1287186,
            1604525, 1595588, 1750968, 1752839, 1350487, 1383537, 1386864, 1403559, 1583116,
            1454248, 1381880, 1608117, 1649609, 1684284, 1704525, 1713765, 1370276, 1473061,
            1592029, 1314607, 1332493, 1425425, 1311369, 1627904, 1782926, 1507580, 1592037,
            1317856, 1474789, 1524988, 1618904, 1620703, 1604549, 1306526, 1563636, 1627914,
            1782936, 1644187, 1430506, 1734202, 1457683, 1497197, 1765993, 1544259, 1551293,
            1636949, 1669664, 1680642, 1631530, 1474803, 1525002, 1618918, 1620717, 1762243,
            1627925, 1782947, 1702710, 1743531, 1340687, 1691662, 1745399, 1352168, 1393568,
            1662375, 1365349, 1474809, 1509339, 1525008, 1618924, 1620723, 1736079, 1758503,
            1461116, 1400259, 1792414, 1474825, 1525024, 1788634, 1383596, 1403618, 1662397,
            1581398, 1764148, 1644224, 1456014, 1474838, 1509368, 1525037, 1620752, 1762278,
            1417056, 1601019, 1613563, 1473125, 1388601, 1437325, 1649682, 1684357, 1386943,
            1403638, 1588534, 1697224, 1697226, 1606402, 1590320, 1593887, 1638813, 1680696,
            1662422, 1558400, 1700917, 1671550, 1747318, 1561934, 1771700, 1754808, 1775466,
            1811435, 1427199, 1574334, 1601049, 3618389, 3726769, 3800830, 3875620, 3937099,
            3962389, 3968020, 3999062, 4027387, 4213937, 4298530, 4301462, 4333780, 4354409,
            4410649, 4416590, 4467250, 4506185, 4533239, 4569437, 4578509, 4599712, 4624004,
            4645312, 4663615, 4694200, 4721812, 4805134, 4808234, 5081762, 5158550, 5245625,
            5317114, 5333429, 5448334, 5474770, 5481389, 5514544, 5729104, 5752820, 5786785,
            5803805, 5827675, 1732415, 1452642, 1626190, 1666087, 1601055, 1613599, 1734282,
            1633420, 1726855, 1822888, 1518115, 1466323, 1497292, 1766088, 1732440, 1736165,
            1766093, 1535590, 1509433, 1525102, 1619018, 1620817, 1640672, 1762343, 1788712,
            1882548, 1892258, 2085579, 2314043, 2368118, 2631789, 2689439, 2926289, 3004193,
            3264453, 3493121, 1710197, 1743632, 1738038, 1530351, 3586229, 5053157, 1766111,
            1563762, 1628040, 1783062, 1532110, 1525122, 1619038, 1620837, 1762363, 1637077,
            1669792, 1533867, 1619047, 1620846, 1762372, 1788741, 1677121, 1551437, 1637093,
            1669808, 3956836, 1669812, 1628074, 1783096, 1745550, 1622673, 1675316, 1697343,
            1594003, 1642549, 1817248, 1751171, 1753042, 1613699, 1732519, 1695510, 1649813,
            1684488, 1712119, 1624499, 1768058, 1620899, 1762425, 1640755, 1762426, 1788795,
            1706584, 1783132, 1680838, 1684511, 1669870, 1664396, 1668048, 1807781, 1779387,
            1758716, 1800200, 1714021, 1794519, 1766244, 1771902, 1809749, 1959143, 2008918,
            2026990, 2061347, 2180740, 2218477, 2220583, 2258662, 2292782, 2301352, 2309938,
            2420812, 2440648, 2456132, 2469443, 2496173, 2595415, 2599972, 2752597, 2764337,
            2771393, 2804440, 2809177, 2813918, 2904757, 2921648, 2936165, 2970178, 2979932,
            2992147, 3019108, 3061013, 3078352, 3083315, 3100717, 3125662, 3128162, 3170815,
            3256988, 3259540, 3303077, 3310790, 3370222, 3438043, 3459047, 3464308, 3477478,
            3201098, 2012929, 2045145, 3432804, 3474844, 3506542, 1896347, 1906092, 1909997,
            2014937, 3333987, 1840320, 2176572, 2434032, 2447283, 2509597, 2579502, 2643468,
            2717532, 2960445, 3026487, 3043728, 3046195, 3080838, 3254442, 3279997, 3357262,
            3430188, 3522448, 2434033, 2447284, 2509598, 2579503, 2643469, 2717533, 2960446,
            3026488, 3043729, 3080839, 3254443, 3279998, 3357263, 3430189, 3522449, 1867266,
            2147476, 2377030, 2473896, 2606823, 2962881, 2972623, 1961131, 2638877, 2797351,
            3006849, 1971045, 2118578, 2224811, 2385761, 2568170, 2645775, 2698928, 2701251,
            2818676, 3287691, 2363977, 2383579, 2451717, 2498421, 2729206, 2842462, 3244257,
            3292821, 1915873, 2055278, 3485407, 3533080, 2609114, 1969065, 1986957, 2256555,
            2754960, 2766705, 2776119, 2861565, 3135685, 3443305, 2726875, 1910012, 1982976,
            2425232, 2147488, 2377042, 2396698, 2473908, 2606835, 2267189, 1990950, 2002935,
            3466963, 3530431, 3118192, 2128891, 2212191, 2320719, 2485044, 2538816, 3070941,
            3216318, 3419743, 2383592, 2498434, 2842475, 1892480, 2085801, 2314265, 2368340,
            2493968, 2632011, 2689661, 2926511, 3264675, 3493343, 1986969, 2166181, 2284257,
            2344471, 2407662, 2507382, 2523076, 2724552, 2754972, 2773776, 3056097, 3063516,
            3148227, 3178401, 3223932, 3234094, 1925684, 1927646, 2141289, 2288534, 2547839,
            2762018, 3251918, 3226474, 2314270, 2368345, 2632016, 2689666, 2830576, 2926516,
            3004420, 3038825, 3264680, 3493348, 1979012, 2010956, 2254449, 2271461, 2835336,
            2902382, 3036362, 3088316, 3191021, 3440699, 3525131, 1910028, 1919808, 2014968,
            2139225, 2412057, 3334018, 2065444, 2210099, 2604569, 2710576, 3150743, 3165818,
            3208726, 2316425, 3506578, 1947329, 3535762, 2705928, 2914444, 3501288, 2139232,
            2412064, 2425255, 2572732, 3334025, 2392346, 2650406, 3485437, 2014980, 2139237,
            2412069, 2572737, 3372865, 2047213, 2346655, 2907215, 2141308, 2288553, 2547858,
            2762037, 3251937, 2141309, 2288554, 1931594, 2262965, 2387984, 2668859, 2941064,
            3411930, 2120677, 2243869, 2659631, 2792669, 3048712, 3085852, 3331456, 3344371,
            3056124, 2004971, 2604591, 2710598, 2588646, 2712927, 2757349, 3123222, 3241756,
            3323724, 2297125, 2994653, 3336625, 3498662, 3538442, 2033093, 2262974, 3451224,
            3535784, 3514549, 2096056, 2245996, 2405503, 2787955, 2061414, 2180807, 2420879,
            2456199, 2595482, 2809244, 2904824, 2936232, 3125729, 3257055, 3259607, 3310857,
            2037133, 2357515, 2638936, 2797410, 2189168, 1973088, 2067511, 2081763, 2087886,
            2091973, 2151684, 2195448, 2502949, 2518629, 2664261, 2806879, 2900011, 1987012,
            2256610, 2344514, 2556914, 2724595, 2755015, 2766760, 2776174, 3140749, 3178444,
            3223975, 3234137, 3443360, 2041175, 2118638, 2224871, 2297138, 2305716, 2385821,
            2396751, 2568230, 2645835, 2698988, 2701311, 2818736, 2924138, 3287751, 3461750,
            2067514, 2087889, 2091976, 2151687, 2195451, 2518632, 2806882, 2900014, 2229092,
            2657347, 2759714, 2878389, 2883188, 2987334, 2010999, 2112474, 2254492, 2835379,
            3036405, 3191064, 3133243, 2943517, 2172479, 2256619, 2344523, 2442938, 2556923,
            2724604, 2755024, 2766769, 2776183, 2861629, 3140758, 3178453, 3223984, 3234146,
            3443369, 2401139, 2418695, 2715279, 2733947, 3375497, 2002995, 3467023, 3530491,
            2035132, 2075663, 2131013, 2185002, 2738627, 2890403, 3277517, 3024109, 3305733,
            3448623, 3024110, 3467029, 3530497, 2604623, 3150797, 3165872, 2418704, 2467313,
            2747999, 3073484, 2921740, 2112490, 2254508, 2271520, 2835395, 2902441, 3036421,
            3191080, 3440758, 3525190, 2045237, 3432896, 3474936, 3506634, 2412117, 2572785,
            2750347, 2914498, 3334078, 3372913, 3501342, 2023064, 2731625, 2229115, 2511930,
            2878411, 3295471, 2795077, 3110782, 2124844, 2609200, 2931427, 2357553, 2638974,
            2797448, 2137230, 3339255, 2118673, 2224906, 2385856, 2568265, 2645870, 2699023,
            2701346, 3287786, 3461785, 2590971, 3432912, 2609210, 3451276, 3535836, 2263027,
            2762101, 2866447, 3252001, 3485507, 2106354, 3130779, 3155844, 3422448, 2180858,
            2420930, 2595533, 2771511, 2809295, 2904875, 2936283, 2992265, 3125780, 3257106,
            3259658, 3310908, 3459165, 2514192, 2577346, 3188581, 2210183, 2604653, 2710660,
            3150827, 3165902, 3208810, 3352198, 2087936, 2092023, 2151734, 2195498, 2502999,
            2518679, 2806929, 2900061, 2873641, 2131053, 2170440, 2185042, 2738667, 2783298,
            2849728, 2890443, 3277557, 3409392, 2108416, 2418739, 2715323, 3058666, 3375541,
            2145524, 2532164, 2627525, 2629817, 2989829, 3359975, 3456545, 3490800, 2092030,
            2151741, 2503006, 2518686, 2664318, 2806936, 2900068, 2314367, 2454047, 3264777,
            3493445, 2151744, 2195508, 2503009, 2518689, 2806939, 2900071, 2151746, 2195510,
            2518691, 2806941, 2900073, 2588721, 3323799, 2275825, 2299343, 2405575, 2541178,
            2570558, 2620663, 2636707, 2788027, 2929037, 3053732, 3145825, 3401575, 2168370,
            2527677, 2731666, 3110821, 2353248, 2825928, 3422472, 2401198, 2418754, 2584181,
            2734006, 2748049, 3073534, 3375556, 2277965, 2286507, 2471807, 2597835, 2708355,
            2722332, 3191130, 2189242, 2394634, 2460709, 2736347, 2859301, 3318656, 3414634,
            2568303, 3287824, 3365179, 2201812, 2243962, 2252440, 2659724, 2792762, 2953294,
            3048805, 3085945, 3098375, 3344464, 2149688, 2394638, 2460713, 2514221, 2662031,
            2736351, 3031551, 3383360, 3385961, 2609247, 2856917, 2212316, 2320844, 2485169,
            2616104, 2897684, 3419868, 2170467, 2185069, 2738694, 2783325, 2890470, 3277584,
            3409419, 2383718, 2842601, 3277585, 2559258, 2948445, 3339303, 2412178, 2572846,
            2750408, 3334139, 3372974, 2288660, 3252044, 2532196, 2627557, 2629849, 3360007,
            3456577, 3490832, 3509347, 2273718, 2377182, 2396838, 2474048, 2491868, 2606975,
            2916977, 2963033, 2972775, 3218988, 3365193, 2394651, 2399028, 2449651, 2460726,
            2662044, 2736364, 2859318, 3031564, 3186099, 3383373, 3385974, 3391179, 2195539,
            2503040, 2518720, 2664352, 2806970, 2900102, 2227070, 3153380, 2692116, 2588752,
            2713033, 2757455, 3241862, 3323830, 2282258, 2423178, 2823578, 3105864, 3113343,
            3176018, 3206324, 3231689, 3262259, 3285281, 3326409, 3354833, 3398999, 2284397,
            2407802, 2523216, 2755112, 2871291, 3056237, 3063656, 3148367, 3234234, 3517307,
            2248222, 2185088, 2738713, 2783344, 2890489, 3277603, 3409438, 2344614, 2557014,
            2755115, 2766860, 2776274, 3135840, 3140849, 3443460, 2478510, 3406830, 2434201,
            2447452, 2509766, 2717701, 3043897, 3046364, 3081007, 3254611, 3522617, 2318715,
            2438615, 2967917, 3029117, 3103382, 3153392, 3201272, 2420988, 2456308, 2595591,
            2771569, 2809353, 2904933, 2936341, 2992323, 3125838, 3257164, 3259716, 3310966,
            3459223, 2977669, 2738720, 2783351, 2890496, 3277610, 3409445, 2260966, 2361969,
            2489656, 2859337, 3318692, 3385993, 2237648, 2250353, 2359799, 2465183, 2622998,
            2666679, 2950899, 3316118, 3446093, 3213939, 2503061, 2518741, 2664373, 2806991,
            3221550, 3341917, 3504078, 2244001, 2252479, 3344503, 2604722, 2710729, 3150896,
            3165971, 2604723, 2710730, 3150897, 3208880, 3352268, 2320884, 2485209, 2538981,
            2897724, 3071106, 3216483, 3396418, 3419908, 2231320, 2312279, 2847409, 3143375,
            3267394, 3362632, 3480307, 2785725, 2970372, 2301547, 3303272, 2295119, 2494136,
            2868923, 2948486, 3249534, 3275069, 3380808, 2385945, 2568354, 2699112, 2701435,
            2818860, 3287875, 3461874, 3153415, 2241897, 2307989, 2335991, 2416614, 2512031,
            2657471, 2878512, 3295572, 2312287, 2847417, 3143383, 3480315, 2675941, 2290845,
            2359821, 2465205, 2623020, 2666701, 3313566, 3316140, 3446115, 2673632, 2307995,
            2416620, 2478542, 2512037, 2657477, 2685203, 3295578, 3406862, 2252499, 2659783,
            2792821, 2953353, 3048864, 3086004, 3098434, 3344523, 2267375, 2788099, 2325210,
            2290851, 2359827, 2465211, 2623026, 2666707, 3316146, 3446121, 2792825, 2953357,
            3098438, 3344527, 2271638, 2835513, 2902559, 3036539, 3088493, 3191198, 3440876,
            3525308, 2344654, 2724735, 2755155, 2766900, 2776314, 3135880, 3178584, 3224115,
            3234277, 3443500, 2310151, 2764550, 2804653, 2814131, 3128375, 3171028, 2362004,
            2489691, 2938802, 2427630, 2866548, 2880927, 3198783, 2383781, 2842664, 2778675,
            2873736, 2835521, 2902567, 3036547, 3088501, 3191206, 3440884, 3525316, 2701458,
            2917037, 2963093, 2972835, 3219048, 3365253, 2299429, 2541264, 2570644, 2620749,
            2636793, 3034086, 3053818, 3145911, 3401661, 2286587, 2471887, 2597915, 2722412,
            2845054, 2392526, 2650586, 2720081, 2423236, 2823636, 3206382, 2755168, 3140902,
            3234290, 2471891, 2597919, 2722416, 2845058, 2548035, 3252114, 2359846, 2465230,
            2623045, 2666726, 3313591, 3316165, 3446140, 2440877, 3477707, 2494170, 2868957,
            2948520, 3249568, 3275103, 3380842, 2377253, 2474119, 2607046, 2541275, 2620760,
            3034097, 3053829, 3378245, 3477711, 2892956, 2396913, 2568392, 2645997, 2985050,
            3066197, 2512068, 3295609, 2764574, 2804677, 2814155, 2591100, 2847455, 3143421,
            3267440, 3362678, 3480353, 2368551, 2632222, 2689872, 2926722, 3029183, 3103448,
            3153458, 2485260, 2539032, 2897775, 3071157, 3419959, 2338197, 2696837, 2852234,
            2476359, 2485270, 2539042, 3216544, 3419969, 2557095, 2755196, 2766941, 3135921,
            3234318, 3443541, 2826045, 3130920, 3155985, 3422589, 2639127, 2797601, 2375103,
            2465262, 2623077, 2666758, 3313623, 3446172, 2383827, 2530050, 2729454, 2842710,
            3244505, 3349752, 2582032, 2632247, 2926747, 3264911, 2465269, 2623084, 2666765,
            3316204, 3446179, 2396946, 2474156, 2607083, 2963141, 3496227, 3490943, 2729463,
            2842719, 2396950, 2568429, 2699187, 2701510, 2818935, 3066234, 3287950, 2941285,
            2593412, 2799981, 2650638, 2720133, 2745840, 3120940, 2399143, 2449766, 2460841,
            2550341, 2662159, 2736479, 2859433, 3318788, 3383488, 3386089, 3391294, 2474165,
            2491985, 2568434, 2607092, 3066239, 3365310, 2460843, 2736481, 2859435, 3383490,
            3391296, 2418892, 2584319, 2734144, 3375694, 3024303, 3448817, 2507635, 2755225,
            3056350, 3063769, 3148480, 3234347, 2572974, 3334267, 3373102, 2977777, 2512118,
            2584327, 2734152, 2748195, 2958295, 3073680, 3375702, 2456420, 2595703, 2771681,
            2809465, 2905045, 2936453, 2992435, 3125950, 3257276, 3259828, 3311078, 3459335,
            2823701, 3105987, 3113466, 3176141, 3206447, 3231812, 3262382, 3285404, 3326532,
            3354956, 3399122, 2854668, 2881003, 3198859, 2492001, 2447572, 2509886, 2579791,
            2643757, 2717821, 2960734, 3026776, 3044017, 3046484, 3081127, 3254731, 3280286,
            3357551, 3430477, 3522737, 3071210, 3201393, 3477775, 2755241, 3234363, 3443586,
            2509892, 2579797, 2643763, 2717827, 2960740, 3026782, 3046490, 3081133, 3254737,
            3280292, 3522743, 2460866, 2736504, 2859458, 3386114, 3391319, 2771697, 2809481,
            2905061, 2936469, 2992451, 3125966, 3259844, 2975358, 2662189, 2736509, 2859463,
            3383518, 3386119, 3391324, 2623125, 2666806, 2951026, 3313671, 3316245, 3446220,
            2748217, 2958317, 3073702, 3128472, 2598004, 2708524, 2722501, 2802384, 2845143,
            2607127, 3472519, 3406971, 2685314, 2539107, 2616270, 3071232, 3216609, 3396544,
            3420034, 3219148, 3365353, 3472527, 2869048, 2948611, 3068759, 3249659, 3275194,
            3380933, 2905079, 2842771, 3293130, 2518883, 2664515, 2807133, 2900265, 2534613,
            2755270, 3148525, 3234392, 2579825, 2643791, 2717855, 2960768, 3026810, 3044051,
            3046518, 3081161, 3254765, 3280320, 3357585, 3430511, 3522771, 2878642, 3295702,
            3120995, 2632314, 3004718, 2664522, 2807140, 2900272, 2755277, 2774081, 3063821,
            3148532, 3234399, 2876250, 3021900, 2729529, 2990040, 3425286, 3456756, 3491011,
            3509526, 2897874, 3216633, 3396568, 3420058, 2570765, 2611724, 2620870, 3034207,
            3053939, 3146032, 3401782, 2876262, 2755292, 2767037, 2776451, 2861897, 3136017,
            3141026, 3178721, 3224252, 3234414, 3443637, 3239502, 2826140, 2646116, 2699269,
            2701592, 2769394, 2819017, 2924419, 2985169, 3066316, 3288032, 3462031, 2611737,
            3034220, 3334339, 3373174, 3188820, 2717886, 2960799, 3026841, 3044082, 3046549,
            3081192, 3254796, 3280351, 3430542, 3522802, 2926843, 2748269, 3375776, 3388777,
            2713231, 2757653, 3242060, 3324028, 2847581, 3143547, 3362804, 3480479, 2771759,
            2809543, 2905123, 2936531, 2992513, 3126028, 3259906, 3311156, 3459413, 2708580,
            2722557, 2845199, 3128530, 3171183, 2710910, 3151077, 3166152, 3209060, 3520160,
            2972986, 3219199, 3365404, 3146063, 3401813, 2678427, 2636949, 3034242, 3053974,
            3146067, 3401817, 2666876, 3313741, 3446290, 3009669, 2630070, 3360228, 3388795,
            3425328, 3456798, 3491053, 3509568, 3360229, 3456799, 2926865, 3004769, 2797727,
            3076258, 2717914, 2960827, 3044110, 3254824, 3357644, 3430570, 3522830, 2699303,
            2769428, 2819051, 3066350, 3288066, 3462065, 2720248, 3031793, 2849994, 2708605,
            2722582, 2953541, 3098622, 3344711, 2736598, 3383607, 3386208, 3391413, 2807204,
            2900336, 3313760, 3316334, 3446309, 2811948, 3435823, 3404451, 2926890, 3004794,
            3493722, 2701649, 2769451, 2819074, 2924476, 3288089, 3462088, 2769452, 2924477,
            3288090, 3462089, 3388828, 3491086, 2914817, 3501661, 2722605, 2802488, 3151123,
            3166198, 3209106, 3242114, 3324082, 3375833, 2960859, 3026901, 3044142, 3046609,
            3081252, 3280411, 3357676, 3430602, 3522862, 2755365, 2776524, 3136090, 3224325,
            3234487, 2842872, 3244667, 3349914, 2795403, 3111108, 2748334, 3375841, 2859584,
            3318939, 3383639, 3386240, 3391445, 2783601, 2890746, 3277860, 3409695, 3226872,
            3496388, 3121096, 2958440, 3073825, 3375847, 2776537, 3056503, 3063922, 3141112,
            3178807, 3224338, 3234500, 3443723, 3324101, 2883549, 2987695, 2814357, 2776542,
            2861988, 3136108, 3141117, 3224343, 3443728, 2809619, 2905199, 2936607, 2992589,
            3126104, 3259982, 3311232, 3234508, 3136112, 3178816, 3224347, 3234509, 3443732,
            2890765, 3277879, 3409714, 3183864, 3076322, 2953598, 3049109, 3086249, 3098679,
            3344768, 3111135, 3128618, 2900397, 2905215, 2936623, 2992605, 3259998, 3459505,
            2922108, 3288140, 3462139, 3106162, 3176316, 3206622, 3231987, 3285579, 3326707,
            3355131, 3399297, 2857232, 3156193, 2902817, 3036797, 3088751, 3191456, 3441134,
            3525566, 3242168, 3349962, 3143657, 3267676, 3362914, 3480589, 2890793, 3409742,
            3204104, 3046668, 3318991, 3148678, 3234545, 2948773, 3068921, 3249821, 3275356,
            3381095, 3148682, 3517622, 3022051, 3199056, 2987747, 3277924, 3409759, 3420212,
            3036825, 3088779, 3441162, 3525594, 2936663, 2992645, 3126160, 3257486, 3260038,
            3311288, 3459545, 2963376, 2973118, 3219331, 3288184, 3173840, 2992658, 3126173,
            3257499, 3260051, 3311301, 3459558, 3068954, 3249854, 3275389, 3381128, 3000005,
            3049176, 3086316, 3098746, 3344835, 3044244, 3046711, 3254958, 3357778, 3430704,
            2973137, 3219350, 3221888, 3504416, 3103731, 3153741, 3219354, 3472738, 3425481,
            3509721, 3126196, 3260074, 3311324, 3459581, 3499137, 3538917, 3044271, 3046738,
            3081381, 3254985, 3430731, 3522991, 3103756, 3153766, 3383762, 3386363, 3391568,
            3054148, 3146241, 3237159, 3088834, 3191539, 3441217, 3525649, 3265200, 3493868,
            3046745, 3081388, 3280547, 3522998, 3081389, 3254993, 3280548, 3430739, 3344874,
            3146249, 3401999, 3234625, 3375976, 3303639, 3148761, 3249903, 3275438, 3255007,
            3280562, 3430753, 3523013, 3344889, 3441238, 3525670, 3344894, 3438621, 3153796,
            3113757, 3176432, 3206738, 3262673, 3355247, 3399413, 3176435, 3206741, 3232106,
            3262676, 3285698, 3326826, 3355250, 3399416, 3324252, 3257576, 3260128, 3311378,
            3459635, 3443880, 3178966, 3234659, 3443882, 3267797, 3363035, 3480710, 3402036,
            3517735, 3166380, 3209288, 3352676, 3520388, 3493922, 3206766, 3232131, 3326851,
            3355275, 3399441, 3234674, 3443897, 3441279, 3525711, 3232143, 3355287, 3399453,
            3352699, 3536345, 3365658, 3342358, 3483379, 3504519, 3443915, 3270386, 3285745,
            3326873, 3355297, 3399463, 3443919, 3430822, 3523082, 3459687, 3311431, 3459688,
            3355309, 3399475, 3493958, 3363084, 3381259, 3409915, 3357906, 3430832, 3523092,
            3428215, 3355318, 3399484, 3462329, 3459708, 3446574, 3446575, 3355334, 3499273,
            3504566, 3520467, 3399511, 3430862, 3425628, 3457098, 3480796, 3386502, 3391707,
            3391708, 3415180, 3425639, 3494008, 3420411, 3509893, 3523150, 3507248, 3491390,
            3509905, 3531129, 3504620, 3533793, 3509918, 3539115, 3576462, 4314177, 4812312,
            5367111, 5835481, 4005697, 5876541, 4019859, 4102480, 4264404, 5459220, 5770771,
            4065341, 4243994, 3676072, 4079607, 4930898, 5050921, 4148429, 4756655, 4937180,
            5204594, 5859423, 3910082, 3662538, 4812325, 5835494, 5028710, 3600582, 3757849,
            3882184, 4381999, 5869704, 3659840, 3763333, 5393366, 5605558, 3871052, 3757853,
            3882188, 4337723, 5399938, 5869708, 4314200, 4741265, 5797995, 3651737, 4352461,
            5108296, 5764001, 4051122, 3714138, 4670729, 4793749, 5655892, 3727775, 3876626,
            4806140, 4612857, 5373696, 5770799, 3779820, 3857170, 3871065, 4249849, 4738197,
            5127495, 5363872, 3779824, 3871069, 4249853, 4738201, 4858984, 4704411, 5767411,
            5764017, 4525231, 5492344, 4276131, 4946647, 3985961, 5031914, 5439461, 5612283,
            5666006, 3865522, 5288838, 3697837, 3873869, 4320107, 4477252, 4540294, 5324669,
            5512256, 4220777, 4399812, 4799970, 4597714, 4320110, 4477255, 4606814, 4732069,
            4840324, 4852774, 5063690, 5512259, 3901748, 4311300, 4615923, 4655495, 5198196,
            4582574, 3804627, 5642485, 5709855, 5044628, 5508949, 3826724, 3846107, 4290785,
            4756715, 4772145, 4849670, 5377010, 4299576, 4355455, 4507231, 4806180, 5730150,
            4128359, 4877734, 4314249, 4741314, 4582585, 5842388, 3910147, 4370228, 4465316,
            4865259, 5426309, 5249919, 5832144, 3882246, 4337781, 4759811, 3777120, 3868332,
            4564452, 4962417, 5124342, 5140357, 5149978, 5602273, 4276169, 5423021, 4031286,
            4513251, 4652472, 4975029, 5360649, 5585559, 3857225, 4738252, 4370240, 4465328,
            4865271, 4846579, 5416446, 3971905, 4429553, 4729028, 5249933, 5337764, 5380313,
            3799144, 4197610, 4459359, 5105169, 5525580, 4235350, 4279105, 4567486, 5038306,
            3963462, 4334853, 4600785, 4664688, 4695273, 5449407, 5828748, 5324713, 5495716,
            5188572, 4073994, 4177368, 4261584, 4501263, 5770871, 5897226, 4290822, 4796924,
            4320161, 4606865, 5862947, 4827943, 4290829, 4756759, 5598960, 3871148, 4738280,
            4317231, 5337789, 5380338, 5535579, 4516291, 4962456, 4965606, 5124381, 5602312,
            4249937, 4738285, 4732133, 5063754, 5298668, 4704496, 5227313, 5645905, 4382106,
            5869811, 4059763, 4796943, 4855957, 5350873, 5130793, 5452741, 4855961, 4311373,
            4522314, 4615996, 4649469, 4655568, 4868433, 5198269, 5545578, 5750538, 4399889,
            4501294, 4217951, 4837290, 5693046, 4014324, 4905942, 5117997, 5436252, 4188968,
            4209247, 5456051, 3949445, 4323130, 4915345, 4022834, 4453440, 5499074, 4334902,
            4570559, 5475892, 5828797, 4896563, 4775314, 4226681, 4323140, 4576610, 4915355,
            3971966, 4414748, 4334911, 4579640, 4600843, 4695331, 4305531, 4504320, 5032029,
            5612398, 4735250, 4981415, 4238332, 4698407, 5013022, 5737018, 4411793, 4468394,
            4809378, 5318258, 4552468, 5622460, 4420711, 4905979, 5436289, 4102651, 5839071,
            5344383, 4111250, 4139965, 4287967, 4408835, 4513345, 4658665, 5070175, 5224135,
            4151480, 5201540, 5383680, 5767550, 5028876, 4105523, 4918523, 5298728, 4655620,
            5315016, 4396977, 5466013, 4856019, 5612424, 4111261, 4139976, 4408846, 4921667,
            5214457, 4264592, 4824918, 4949938, 5272734, 4818710, 5652695, 5354211, 5073376,
            4174574, 4729133, 5535659, 4114137, 5662789, 4244190, 4209313, 5302003, 5499133,
            5716753, 4264604, 5839100, 5324818, 4223831, 4622146, 4831144, 4959392, 4139993,
            4287995, 4513373, 5070203, 5224163, 4683139, 5370595, 5733674, 4735296, 5292249,
            4232558, 5282497, 5869897, 4877876, 5423151, 5605751, 5073395, 5452826, 5562320,
            4943672, 4408873, 4513383, 4658703, 5070213, 5224173, 5720150, 4846709, 5856212,
            4582733, 4893514, 4483408, 5656090, 4220950, 4261711, 4501390, 4818746, 5652731,
            5143713, 5406720, 5832297, 4843610, 5716784, 5791397, 4252966, 4332049, 4459502,
            5105312, 5302041, 5595741, 4834290, 4261726, 4400000, 4800158, 4818761, 5652746,
            4423757, 4622186, 4831184, 4959432, 5185496, 4323237, 4576707, 4915452, 5393594,
            4382229, 4402970, 5282534, 5869934, 4279260, 5038461, 4698491, 5737102, 4775417,
            4616117, 5054345, 4738418, 4859201, 4332069, 4775421, 4818775, 4285121, 5162998,
            5459476, 5839156, 5114924, 5188731, 5423202, 4567656, 5038476, 5866526, 4610057,
            5839163, 4756915, 5686436, 5726967, 5893959, 5730352, 4504434, 4616139, 4655711,
            5198412, 5545721, 5706689, 4741518, 4477475, 4607034, 4367476, 4570697, 4579769,
            4695460, 4723072, 5449594, 4382265, 4698526, 5737137, 4498450, 4713865, 5764265,
            4468517, 4507452, 4806401, 5515811, 5276082, 4465534, 4865477, 5429823, 5612533,
            4447630, 5390362, 5282585, 5869985, 4501466, 4800219, 4818822, 5243669, 5652807,
            5869992, 5070305, 4809520, 5246911, 5476058, 5482677, 4906119, 4831252, 4959500,
            5185564, 5894002, 5380536, 5305373, 5221043, 5390385, 5095820, 5499254, 4483506,
            5575776, 5656188, 5105401, 4543578, 5003690, 4865509, 4625309, 4809539, 5515849,
            5092635, 5253410, 5022687, 5615916, 4607087, 5512532, 4588899, 4643574, 4915538,
            5227523, 5599181, 4720055, 4818856, 5243703, 5652841, 4806452, 5730422, 5224300,
            4962680, 4965830, 5403546, 5585816, 5602536, 5492649, 4576810, 4744670, 5502596,
            5659580, 5839250, 5542471, 5622645, 5569134, 4735445, 5703395, 4692473, 5124620,
            5364195, 5124621, 5140636, 5038573, 5829014, 4588931, 4744685, 4915570, 4601054,
            5449676, 4859313, 5713537, 4931262, 4664964, 4695549, 5662964, 4853090, 5064006,
            5156690, 5433195, 5512575, 5459592, 5659602, 4649714, 4655813, 4868678, 5198514,
            5545823, 5750783, 5032245, 4831318, 4959566, 4809591, 5083119, 5240508, 4784821,
            4797199, 4865565, 5509267, 4868689, 5054480, 5545834, 5750794, 5198527, 5545836,
            5706804, 5070388, 5224348, 4695570, 4794116, 5656259, 5472839, 5737256, 4975349,
            5000609, 5019596, 5276200, 4840681, 4853131, 4918756, 5064047, 5354432, 5433236,
            5512616, 5689955, 4859364, 5502666, 5073602, 5131085, 5562527, 4850025, 5282710,
            5237317, 5328303, 5102310, 4928186, 5456348, 5575887, 5656299, 4896854, 5652939,
            5542555, 5083179, 5247042, 5318531, 5730521, 5835922, 5143924, 5652945, 4934475,
            4950191, 5115109, 5272987, 5552552, 5629441, 5545892, 5579237, 4959634, 5693361,
            4918791, 5086377, 5512651, 5416808, 5897574, 5221179, 5064086, 5439869, 5612691,
            5198596, 5545905, 5750865, 5073644, 5562569, 5436588, 5086402, 5214743, 5781437,
            5489468, 5172861, 5205067, 5646264, 5846216, 5115149, 5273027, 5717038, 5791651,
            5099177, 4965975, 4975431, 5124750, 5292528, 5585961, 5602681, 5416847, 5767862,
            5771258, 5897613, 5000695, 5019682, 5292532, 5105573, 5019690, 5901058, 5325117,
            5663097, 5616094, 5439925, 5612747, 5227705, 5713687, 5060970, 5354538, 5512722,
            5562630, 5733991, 5676583, 5160054, 5489519, 5140816, 5602732, 5666498, 5602737,
            5632897, 5516072, 5839449, 5367664, 5569330, 5663149, 5795125, 5894248, 5683358,
            5546009, 5750969, 5384065, 5767935, 5856556, 5328452, 5393923, 5516099, 5629582,
            5489576, 5486272, 5639659, 5552704, 5440013, 5819017, 5370991, 5348082, 5380827,
            5512812, 5403815, 5589429, 5592773, 5764594, 5407108, 5536081, 5767991, 5606162,
            5768001, 5771397, 5856622, 5897752, 5606171, 5822461, 5612873, 5592795, 5802014,
            5483014, 5751075, 5629667, 5873789, 5656542, 5734149, 5802059, 5791848, 5636397,
            5646471, 5646477, 5839600, 5901259, 5802101, 5856727, 5897857, 5897858, 5901312,
            5897883, 5966768, 6001353, 6008282, 6060377, 6102215, 6154715, 6274548, 6295815,
            6310013, 6317118, 6370533, 6413427, 6478038, 6503252, 6539357, 6640983, 6651918,
            6710390, 7002848, 7062840, 7085403, 7108002, 7119315, 7160873, 7232940, 7290090,
            7451307, 7482215, 7540340, 7735715, 7782977, 7818518, 7834340, 7866032, 6095233,
            7416615, 7873968, 6706732, 6029098, 6791212, 6976687, 7044070, 7332149, 6427766,
            6835504, 6787535, 7206359, 7221549, 6492455, 7324506, 7412780, 6677487, 7885891,
            7305389, 6644649, 6485260, 7486109, 7806688, 6008309, 6317145, 7085430, 7783004,
            7358995, 6317147, 7160902, 7783006, 7606518, 6590104, 7665124, 7104266, 6070857,
            6521326, 6791242, 6363434, 7328353, 7416650, 7723960, 6831838, 7021609, 7870039,
            6413471, 7540384, 6306512, 6327834, 6395588, 6467298, 6743444, 7336023, 7517114,
            7708263, 7626050, 7393581, 6865154, 6130245, 6798636, 7755448, 7126921, 7339861,
            6535803, 6611928, 6352765, 7316899, 7092995, 7755454, 7221603, 6839258, 6809712,
            6641054, 7735786, 7040386, 6917132, 7731859, 6345657, 6761843, 6225146, 6496124,
            6958103, 7236824, 7313094, 7366721, 6406350, 6743476, 6302996, 6384899, 6474524,
            6586527, 6349228, 6761851, 7802800, 6496134, 6958113, 7236834, 7313104, 7366731,
            6288816, 7134508, 7332238, 6367062, 6543070, 6564788, 7532675, 7505539, 7866137,
            7559872, 6761871, 7571540, 6568425, 6384928, 7355248, 7783094, 6388508, 6467367,
            6633818, 7700484, 6384937, 7712262, 6725174, 6765567, 7316964, 6543104, 7233072,
            6395674, 6467384, 6633835, 7336109, 7517200, 6467386, 6633837, 7336111, 7517202,
            7708351, 6684917, 7145887, 7540484, 6456612, 6553974, 7153455, 7195112, 7301694,
            7618337, 7622240, 7089316, 7255923, 7688750, 7347619, 7669162, 6868958, 7153464,
            7195121, 6659370, 7336129, 6601124, 6633857, 6743552, 6750897, 7210302, 7336131,
            7517222, 7708371, 6710552, 7119477, 7630066, 6958189, 7055494, 7236910, 7366807,
            7378324, 7657432, 7794982, 6798746, 7755558, 7478519, 6601137, 7210315, 7336144,
            7517235, 7802885, 7814738, 7078052, 7066773, 7259757, 6612045, 6652097, 7309370,
            6787707, 7791054, 6626607, 6750934, 7210339, 7336168, 7501761, 7517259, 7217939,
            7598892, 6681326, 7432228, 7259791, 7336184, 7552206, 7463115, 6846819, 6854221,
            7210378, 7517298, 7708447, 7336209, 6809885, 7199001, 7382245, 7443840, 7755640,
            7149780, 7336226, 7416868, 7681016, 7021827, 7870257, 7340062, 7700631, 7195234,
            6950838, 7806936, 6995643, 7347746, 7587284, 7874249, 7677125, 7799053, 7237036,
            7313306, 7657558, 6980711, 7044363, 7183892, 7751754, 7818823, 7575629, 7673229,
            7870308, 7164976, 7313332, 7378476, 7795134, 7085724, 7290411, 7783298, 7677162,
            7544548, 7290417, 7902099, 7332483, 7195310, 7677192, 7614641, 7610741, 7630259,
            7336332, 7313380, 7367007, 7657632, 7591270, 7467129, 7799140, 7642008, 7787308,
            7367027, 7657652, 7501958, 7708605, 7830783, 7795219, 7775504, 7874379, 7755811,
            7866455, 7622517, 7583534, 7803147, 7517499, 7673378, 7638175, 7830845, 7763732,
            7906224, 7858622, 7930151, 8078151, 8082170, 8086190, 8090211, 8086192, 7954063,
            8074150, 8094250, 8106325, 8126467, 8122452, 8094271,
        ];

        let mut recovery = SparseRecovery::<FieldHasher>::init(8154741, 484, 0.01);

        stream
            .into_iter()
            .for_each(|token| recovery.feed((token, true)));

        recovery.query()
    }

    #[test]
    fn large_vec() {
        let n = 10;

        let mut incorrect = 0;

        for _ in 0..n {
            let res = foobar();
            if res.is_some() {
                incorrect += 1;
            }
        }

        let probability = incorrect as f32 / n as f32;
        println!("{:?}", probability)
    }
}
